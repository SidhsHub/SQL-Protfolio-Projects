"sales_month"	"naics_code"	"kind_of_business"			"reason_for_null"	"sales"
"1992-01-01"	"44811"			"Men's clothing stores"							701
"1992-01-01"	"44812"			"Women's clothing stores"						1873
"1992-02-01"	"44811"			"Men's clothing stores"							658
"1992-02-01"	"44812"			"Women's clothing stores"						1991
"1992-03-01"	"44811"			"Men's clothing stores"							731

SELECT
	sales_month,
	kind_of_business,
	sales,
	sum(sales) OVER (PARTITION by sales_month) as monthly_sales,
	round(sales / sum(sales) OVER (PARTITION by sales_month), 2) *100 as pct_of_total
FROM
	RETAIL_SALES
WHERE
	KIND_OF_BUSINESS IN (
		'Women''s clothing stores',
		'Men''s clothing stores'
	)

--OR 

  SELECT
	A.sales_month,
	A.kind_of_business,
	A.sales,
	sum(B.sales),
	round(A.sales / sum(B.sales), 2) *100 as pct_of_total
FROM
	RETAIL_SALES A
	JOIN RETAIL_SALES B ON A.SALES_MONTH = B.SALES_MONTH
	AND B.KIND_OF_BUSINESS IN (
		'Women''s clothing stores',
		'Men''s clothing stores'
	)
WHERE
	A.KIND_OF_BUSINESS IN (
		'Women''s clothing stores',
		'Men''s clothing stores'
	)
group by 1,2,3 order by 1

"sales_month"	"kind_of_business"	      "sales"	"sum"	"pct_of_total"
"1992-01-01"	"Men's clothing stores"    	701	  2574	27.00
"1992-01-01"	"Women's clothing stores"  	1873	2574	73.00
"1992-02-01"	"Men's clothing stores"	    658	  2649	25.00
"1992-02-01"	"Women's clothing stores"  	1991	2649	75.00
"1992-03-01"	"Men's clothing stores"	    731	  3134	23.00

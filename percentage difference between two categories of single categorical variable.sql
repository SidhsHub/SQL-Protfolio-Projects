"date_part"	"mens_sales"	"womens_sales"	"women_times_men"	"pct_of_diff"
1992	10179	31815	3.1255526083112290	212.5552608311229000
1993	9962	32350	3.2473398915880345	224.7339891588034500
1994	10032	30585	3.0487440191387560	204.8744019138756000
1995	9315	28696	3.0806226516371444	208.0622651637144400
1996	9546	28238	2.9580976325162372	195.8097632516237200
/*SELECT
DATE_PART('year', SALES_MONTH),
SUM(
CASE
WHEN KIND_OF_BUSINESS = 'Women''s clothing stores' THEN SALES
END
) - SUM(
CASE
WHEN KIND_OF_BUSINESS = 'Men''s clothing stores' THEN SALES
END
) AS WOMENS_MINUS_MENS
FROM
RETAIL_SALES
GROUP BY
1
*/
SELECT
	*,
	WOMENS_SALES / MENS_SALES AS WOMEN_TIMES_MEN,
	(WOMENS_SALES / MENS_SALES - 1) * 100 AS PCT_OF_DIFF
FROM
	(
		SELECT
			DATE_PART('year', SALES_MONTH),
			SUM(
				CASE
					WHEN KIND_OF_BUSINESS = 'Men''s clothing stores' THEN SALES
				END
			) AS MENS_SALES,
			SUM(
				CASE
					WHEN KIND_OF_BUSINESS = 'Women''s clothing stores' THEN SALES
				END
			) AS WOMENS_SALES
		FROM
			RETAIL_SALES
		WHERE
			SALES_MONTH <= '2019-12-01'
		GROUP BY
			1
	)
ORDER BY
	1
LIMIT
	5
	
"date_part"	"mens_sales"	"womens_sales"	"women_times_men"	"pct_of_diff"
1992	10179	31815	3.1255526083112290	212.5552608311229000
1993	9962	32350	3.2473398915880345	224.7339891588034500
1994	10032	30585	3.0487440191387560	204.8744019138756000
1995	9315	28696	3.0806226516371444	208.0622651637144400
1996	9546	28238	2.9580976325162372	195.8097632516237200
